<div class="container mb-3 search-style">
  <div class="row justify-content-start shadow-sm mb-3 p-4 bg-white">
    <div class="flex-column col-sm-12 col-md-4">
      <label for="from">اسم الفرع</label>
      <p-select
      id="from"
      [showClear]="true"
      [options]="(serachBranches$ | async) || []"
      optionLabel="nameAr"
      optionValue="id"
      [style.width.%]="100"
      [(ngModel)]="searchCriteria.branchId" placeholder="اختر اسم الفرع" />
    </div>
    <div class="col-sm-12 col-md-4"></div>
    <div class="flex-column d-flex align-items-end justify-content-end mt-3 col-sm-12 col-md-4">
      <button [icon]="'pi pi-search'" class="w-50 btn-search" (click)="search()" pButton>بحث</button>
    </div>
  </div>
</div>
<div class="container mb-3 container-style">
  <div class="row text-start my-4 p-2">
    <div class="col d-flex justify-content-end">
      <button class="btn-color btn-search" pButton (click)="showDialog()">اضف شريحه</button>
    </div>
  </div>
  <div class="row p-2 bg-white shadow-sm">
    <div class="transactions-wrapper">
      <p-toast></p-toast>
      <p-confirmDialog></p-confirmDialog>
      <p-table [value]="(sims$ | async) || []" class="p-datatable-sm">
        <ng-template pTemplate="header">
          <tr>
            <th>رقم الشريحه</th>
            <th>الفرع</th>
            <th>الرصيد اليومي</th>
            <th>الرصيد الشهرى</th>
            <th>الرصيد الكلى</th>
            <th>الحاله</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-t>
          <tr>
            <td>{{ t.phoneNumber }}</td>
            <td>{{ t.branch?.nameAr }}</td>
            <td>{{ t.dailyBalance }}</td>
            <td>{{ t.monthlyBalance }}</td>
            <td>{{ t.totalBalance }}</td>
            <td> <span class="status"
              [ngClass]="{'status-active' : t.status == 'ACTIVE', 'status-inactive' : t.status == 'INACTIVE'}">
              {{ t.status == 'ACTIVE'? 'نشط' : 'غير نشط' }}
             </span></td>
            <td>
              <button pButton icon="pi pi-trash" class="p-button-danger p-button-sm btn-delete"
                (click)="deleteSim(t)"></button>
            </td>
          </tr>
        </ng-template>
        <ng-template #emptymessage>
          <app-loading-overlay [show]="isLoading" text="انتظر لحظه..."></app-loading-overlay>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>


<p-dialog header="اضافه فرع جديد" [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }">
  <form [formGroup]="form" (ngSubmit)="addSim()">
    <div class="form-group">
      <label for="phoneNumber" class="font-semibold w-24">رقم الشريحه</label>
      <input [style.width.%]="100" formControlName="phoneNumber" pInputText id="phoneNumber" class="flex-auto"
        autocomplete="off" />
    </div>
    <div class="form-group">
      <label for="branch" class="font-semibold w-24">الفرع</label>
      <p-select [style.width.%]="100" id="branch" [appendTo]="'body'" [options]="(branches$ | async) || []"
        optionLabel="nameAr" formControlName="branch" />
    </div>



    <div class="form-group">
      <label for="nameAr" class="font-semibold w-24">الرصيد الكلى</label>
      <p-inputNumber id="nameAr" class="flex-auto" [style.width.%]="100" formControlName="totalBalance" />
      <!-- <input [style.width.%]="100" formControlName="nameEn" pInputText id="nameAr" class="flex-auto" autocomplete="off" /> -->
    </div>

    <div class="form-group">
      <label for="dailyBalance" class="font-semibold w-24">الرصيد اليومي</label>
      <p-inputNumber id="dailyBalance" class="flex-auto" [style.width.%]="100" formControlName="dailyBalance" />
      <!-- <input [style.width.%]="100" formControlName="nameEn" pInputText id="nameAr" class="flex-auto" autocomplete="off" /> -->
    </div>

    <div class="form-group">
      <label for="monthlyBalance" class="font-semibold w-24">الرصيد الشهرى</label>
      <p-inputNumber id="monthlyBalance" class="flex-auto" [style.width.%]="100" formControlName="monthlyBalance" />
      <!-- <input [style.width.%]="100" formControlName="nameEn" pInputText id="nameAr" class="flex-auto" autocomplete="off" /> -->
    </div>


    <div class="flex justify-end gap-2">
      <button pButton class="btn-delete ms-2" (click)="visible = false">الغاء</button>
      <button pButton class="btn-search" type="submit">حفظ</button>
    </div>
  </form>
</p-dialog>
