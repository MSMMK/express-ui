<div class="container-fluid search-style">
  <div class="row justify-content-start shadow-sm mb-3 p-4 bg-white">
    <div class="form-group col-sm-12 col-md-6 col-lg-3">
      <label for="from">مدير الفرع</label>
      <p-select
        id="from"
        [style.width.%]="100"
        [options]="(users$ | async) || []"
        optionLabel="username"
        [(ngModel)]="searchCriteria.userId"
        optionValue="id"
        placeholder="اختر موظف"
      />
    </div>
    <div class="form-group col-sm-12 col-md-6 col-lg-3">
      <label for="from">الشريحه</label>
      <p-select
        id="from"
        [style.width.%]="100"
        [options]="(sims$ | async) || []"
        [(ngModel)]="searchCriteria.simId"
        optionLabel="phoneNumber"
        optionValue="id"
        placeholder="اختر رقم شريحه "
      />
    </div>
    <div class="col-sm-12 col-md-6 col-lg-4">
      <label for="from">الفرع</label>
      <p-select
        id="from"
        [style.width.%]="100"
        [options]="(branchs$ | async) || []"
        optionLabel="nameAr"
        [(ngModel)]="searchCriteria.branchId"
        optionValue="id"
        placeholder="اختر فرع "
      />
    </div>
    <div
      class="form-group d-flex align-items-center justify-content-end mt-3 col-sm-12 col-md-6 col-lg-2"
    >
      <button
        [icon]="'pi pi-search'"
        class="w-50 btn-search"
        type="button"
        (click)="serch()"
        pButton
      >بحث</button>
    </div>
  </div>
</div>
<div class="container-fluid container-style">
  <div class="my-3">
    <button pButton [icon]="'pi pi-file'" (click)="export()" class="btn-search">استخراج</button>
  </div>
  <div class="row shadow-sm p-2 bg-white">
    <div class="transactions-wrapper">
      <p-toast></p-toast>
      <p-confirmDialog
        [acceptLabel]="'نعم'"
        [rejectLabel]="'لا'"
        [acceptButtonStyleClass]="'btn-delete'"
        [rejectButtonStyleClass]="'btn-search'"
      ></p-confirmDialog>
      <p-table
        [value]="(transactions$ | async) || []"
        class="mt-4"
        [scrollable]="true"
        [paginator]="true"
        [rows]="5"
        [first]="first"
        [showCurrentPageReport]="true"
        [tableStyle]="{ 'min-width': '50rem' }"
        (onPage)="pageChange($event)"
        [rowsPerPageOptions]="[5, 10, 20]"
      >
        <ng-template pTemplate="header">
          <tr>
            <th colspan="7" class="text-center">حول العمليه</th>
            <th colspan="7" class="text-center">الفئات</th>
            <th></th>
            <th></th>
          </tr>
          <tr>
            <th>اسم الموظف</th>
            <th>من شربحه</th>
            <th>اسم/رقم العميل</th>
            <th>اسم الفرع</th>
            <th>القيمه</th>
            <th>الخصم</th>
            <th>1 جنيه</th>
            <th>5 جنيه</th>
            <th>10 جنيه</th>
            <th>20 جنيه</th>
            <th>50 جنيه</th>
            <th>100 جنيه</th>
            <th>200 جنيه</th>
            <th>تاريح العمليه</th>
            <th>ملاحظات</th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-t>
          <tr>
            <td>{{t.user?.username}}</td>
            <td>{{t.sim?.phoneNumber}}</td>
            <td>
              {{t.customer!= undefined ? t.customer.name:
              t.customerPhoneNumber}}
            </td>
            <td>{{t.branch.nameAr}}</td>
            <td>{{t.amount | currency: 'EGP'}}</td>
            <td>{{t.discount | currency: 'EGP'}}</td>
            <td>{{t.oneEgp}}</td>
            <td>{{t.fiveEgp}}</td>
            <td>{{t.tenEgp}}</td>
            <td>{{t.twentyEgp}}</td>
            <td>{{t.fiftyEgp}}</td>
            <td>{{t.oneHundredEgp}}</td>
            <td>{{t.twoHundredEgp}}</td>
            <td>{{t.creationDate | date}}</td>
            <td>{{t.notes}}</td>
            <td>
              <button
                pButton
                (click)="delete(t.id)"
                icon="pi pi-trash"
                class="btn-delete"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
